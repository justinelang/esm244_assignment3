---
title: "Assignment 3 Task 1"
author: "Justine Lang"
date: "2023-03-02"
output: 
  html_document: 
    code_folding: hide
---

```{r setup, include=FALSE, echo = TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(here)
library(janitor)
library(ggfortify)
```

## Data Overview

Text here

```{r}
### Read in the data

env_vars <- read_csv(here("data", "world_env_vars.csv"))
```

```{r}
### Visually inspect for NA's; wind has 55

# summary(env_vars)
```

## Data Wrangling

```{r}
### Drop NA's, clean names, and set levels for accessibility_to_cities

env_vars <- env_vars %>%
  clean_names() %>%
  drop_na() %>% 
  mutate(accessibility_to_cities =
                     case_when(accessibility_to_cities <= 100 ~ "Very High", 
                              accessibility_to_cities <= 500 ~ "High",
                              accessibility_to_cities <= 1000 ~ "Medium",
                              accessibility_to_cities <= 11000 ~ "Low")) %>% 
  mutate(accessibility_to_cities = factor(accessibility_to_cities, levels = c('Low', 'Medium', 'High', 'Very High')))

# glimpse(env_vars)
```

```{r}
### Select variables of interest and scale

env_vars_pca <- env_vars %>%
  select(cropland_cover, tree_canopy_cover, rain_mean_annual, temp_mean_annual, temp_annual_range, wind, cloudiness) %>% 
  dplyr::select(where(is.numeric)) %>%
  scale() %>%
  prcomp()

### See the loadings

# env_vars_pca$rotation
```


## Biplot

```{r}
autoplot(env_vars_pca,
     	data = env_vars,
     	loadings = TRUE,
     	colour = 'accessibility_to_cities',
     	loadings.label = TRUE,
     	loadings.colour = "black",
     	loadings.label.colour = "black",
     	loadings.label.vjust = -0.5
     	) +
  scale_color_manual(values = c('red', 'orange', 'yellowgreen', 'darkgreen')) +
  scale_fill_manual(values = c('red', 'orange', 'yellowgreen', 'darkgreen')) +
  theme_minimal()
```












